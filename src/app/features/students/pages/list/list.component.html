<div class="card">
  <p-toolbar styleClass="mb-4">
    <ng-template pTemplate="left">
      <h3 class="m-0">Estudiantes</h3>
    </ng-template>
    <ng-template pTemplate="right">
      <p-dropdown 
        [options]="statusOptions" 
        [(ngModel)]="selectedStatus" 
        (onChange)="filterByStatus()"
        placeholder="Filtrar por estado"
        styleClass="mr-2">
      </p-dropdown>
      <p-button 
        label="Importar CSV" 
        icon="pi pi-upload" 
        styleClass="p-button-secondary mr-2"
        (onClick)="bulkImport()">
      </p-button>
      <p-button 
        label="Nuevo Estudiante" 
        icon="pi pi-plus" 
        (onClick)="createNew()">
      </p-button>
    </ng-template>
  </p-toolbar>

  <p-table 
    [value]="students" 
    [loading]="loading"
    [paginator]="true"
    [rows]="rows"
    [totalRecords]="totalRecords"
    [lazy]="true"
    (onLazyLoad)="onPageChange($event)"
    [first]="first"
    responsiveLayout="scroll"
    styleClass="p-datatable-gridlines">
    
    <ng-template pTemplate="header">
      <tr>
        <th>CÃ³digo</th>
        <th>Nombres</th>
        <th>Apellidos</th>
        <th>Email</th>
        <th>Estado</th>
        <th style="width: 12rem">Acciones</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-student>
      <tr>
        <td>{{ student.code }}</td>
        <td>{{ student.firstName }}</td>
        <td>{{ student.lastName }}</td>
        <td>{{ student.email }}</td>
        <td>
          <p-tag 
            [value]="getStatusLabel(student.status)" 
            [severity]="getStatusSeverity(student.status)">
          </p-tag>
        </td>
        <td>
          <div class="flex gap-2">
            <p-button 
              icon="pi pi-pencil" 
              styleClass="p-button-rounded p-button-text p-button-warning"
              (onClick)="edit(student)"
              pTooltip="Editar"
              tooltipPosition="top">
            </p-button>
            <p-button 
              *ngIf="student.status === 'ENABLED'"
              icon="pi pi-times" 
              styleClass="p-button-rounded p-button-text p-button-danger"
              (onClick)="disable(student)"
              pTooltip="Deshabilitar"
              tooltipPosition="top">
            </p-button>
            <p-button 
              *ngIf="student.status === 'DISABLED'"
              icon="pi pi-check" 
              styleClass="p-button-rounded p-button-text p-button-success"
              (onClick)="enable(student)"
              pTooltip="Habilitar"
              tooltipPosition="top">
            </p-button>
          </div>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="6" class="text-center">
          <div class="p-4">
            <i class="pi pi-info-circle text-4xl text-400"></i>
            <p class="text-500 mt-3">No se encontraron estudiantes</p>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
